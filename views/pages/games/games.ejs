<%- include('../../partials/head') %>
<%- include('../../partials/navbar.ejs') %>
<body>
    <%if (typeof query.messageToShow != 'undefined' ){%>
    <script>
        function removeBanner(){
            document.getElementById("changeBanner").remove()
        }
    </script>

    <div id="changeBanner" class="banner1">
        <p><%=query.messageToShow%></p>
        <button onclick="removeBanner()">
            X
        </button>
    </div>
    <%}%>

    <div style="display: flex; justify-content: space-around;">
        <a href="/games/add"><button class="button1">Add game</button></a>
    </div>
    
    <div class="mainDiv">
        <div class="header">
            <h1 style="margin-left: 10px;">Games</h1>
            <div class="dropdown">
                <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Filter
                </button>
                <ul class="dropdown-menu">
                    <li><p style="text-align: center; border-bottom: solid 1px; font-size: 20px;">Sort by</p></li>
                    <li><a class="dropdown-item active" href="#">Id</a></li>
                    <li><a class="dropdown-item" href="#">Name</a></li>
                </ul>
            </div>
        </div>
        <div class="gridContainer" id="gridContainer">
            <% gamesArr.forEach((game)=> { %>
                <%- include('../../partials/gamedisplay', {game: game}) %>
            <% }) %>
            <a href="/games/add" class="gameDisplay">
                <div class="card" style="margin-top: 20px;">
                    <div class="card-header">
                        <h4 style="overflow: hidden; height: 30px; text-align: center;">
                            Click to add game
                        </h2>
                    </div>
                    <div class="card-body" style="background-color: rgb(247, 247, 247);">
                        <blockquote class="blockquote mb-0">
                        <p><br></p>
                        <p><br></p>
                        </blockquote>
                    </div>
                </div>
            </a>
        </div>
    </div>


    <script>
        let cardWidth = 500;

        let columnCount = Math.floor(document.documentElement.clientWidth / cardWidth);
        let temp = ""
        for(let i = 0; i < columnCount; i++){
            temp += "auto "
        }
        let newStyle = "grid-template-columns: " + temp;
        document.getElementById("gridContainer").style = newStyle;

        document.body.onresize = () => {
            let columnCount = Math.floor(document.documentElement.clientWidth / cardWidth);
            let temp = ""
            for(let i = 0; i < columnCount; i++){
                temp += "auto "
            }
            let newStyle = "grid-template-columns: " + temp;
            console.log(temp);
            document.getElementById("gridContainer").style = newStyle;
        }
    </script>

</body>
<%- include('../../partials/footer') %>